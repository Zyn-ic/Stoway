<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InventoryState V1.2 - Stoway Docs</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Outfit:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="icon" href="../assets/Logo.png" />
</head>

<body>
    <div class="bg-gradient"></div>

    <nav class="nav">
        <a href="../index.html" class="nav-logo">
            <img src="../assets/Logo.png" alt="Stoway">
            <h1>Stoway</h1>
        </a>

        <div class="nav-section">
            <div class="nav-section-title">Documentation</div>
            <a href="../index.html" class="nav-link">Home</a>
        </div>

        <div class="nav-section">
            <div class="nav-section-title">Backend V1.2</div>
            <a href="index.html" class="nav-link">Server Overview</a>
            <a href="inventory-service.html" class="nav-link">InventoryService</a>
            <a href="inventory-data.html" class="nav-link active">InventoryState</a>
            <a href="utils.html" class="nav-link">Utilities</a>
            <a href="debug-commands.html" class="nav-link">Debug Commands</a>
        </div>

        <div class="nav-section">
            <div class="nav-section-title">Frontend</div>
            <a href="../client/index.html" class="nav-link">Client Overview</a>
        </div>
    </nav>

    <main class="main">
        <div class="breadcrumb">
            <a href="../index.html">Docs</a>
            <span>/</span>
            <a href="index.html">Server</a>
            <span>/</span>
            <span class="current">InventoryState V1.2</span>
        </div>

        <section>
            <div class="section-header">
                <h2>InventoryState</h2>
                <p>Pure data container for player inventory state (V1.2)</p>
            </div>

            <p style="color: var(--text-secondary); margin-bottom: 2rem;">
                Instantiated per-player. Holds all inventory state including items, slots, equipped status,
                and <strong>per-player settings</strong>. Uses <code class="inline-code">ItemsByID</code> for O(1) stack
                lookups.
            </p>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-title">Type Definitions</span>
                    <span class="code-lang">Luau</span>
                </div>
                <pre><code><span class="keyword">export type</span> ItemInstance <span class="operator">=</span> {
    UUID: <span class="keyword">string</span>,
    Id: <span class="keyword">string</span>,
    Amount: <span class="keyword">number</span>,
    Metadata: { [<span class="keyword">string</span>]: <span class="keyword">any</span> }?
}

export type PlayerSettings = {
    Limit: number,             -- Weight limit (0 = infinite)
    CanStack: boolean,         -- Enable/disable stacking
    MaxStackSize: number,      -- Max items per stack
    MaxHotbarSlots: number,    -- Hotbar slot count
    UiType: string,            -- Interface version to load
}

<span class="keyword">export type</span> InventoryStateType <span class="operator">=</span> {
    Player: Player,
    Items: { [<span class="keyword">string</span>]: ItemInstance },      <span class="comment">-- UUID -> Item</span>
    ItemsByID: { [<span class="keyword">string</span>]: {<span class="keyword">string</span>} },    <span class="comment">-- ItemId -> UUIDs (O(1) lookup)</span>
    Hotbar: { [<span class="keyword">number</span>]: <span class="keyword">string</span>? },          <span class="comment">-- Static: nil holes allowed</span>
    Storage: { <span class="keyword">string</span> },                    <span class="comment">-- Dynamic: packed array</span>
    EquippedItemUUID: <span class="keyword">string</span>?,             <span class="comment">-- UUID of equipped item</span>
    Weight: <span class="keyword">number</span>,                        <span class="comment">-- Total item amounts</span>
    Settings: PlayerSettings,              <span class="comment">-- Per-player settings!</span>
}</code></pre>
            </div>
        </section>

        <section>
            <div class="section-header">
                <h2>V1.2 Changes</h2>
                <p>Key improvements from V1</p>
            </div>

            <table class="api-table">
                <thead>
                    <tr>
                        <th>Feature</th>
                        <th>V1</th>
                        <th>V1.2</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Equipped Tracking</td>
                        <td>Slot-based</td>
                        <td><span class="tag tag-new">UUID-based</span></td>
                    </tr>
                    <tr>
                        <td>Storage</td>
                        <td>Static array</td>
                        <td><span class="tag tag-new">Dynamic (packed)</span></td>
                    </tr>
                    <tr>
                        <td>Settings</td>
                        <td>Global only</td>
                        <td><span class="tag tag-new">Per-player</span></td>
                    </tr>
                    <tr>
                        <td>Weight Tracking</td>
                        <td>Not tracked</td>
                        <td><span class="tag tag-new">state.Weight</span></td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section>
            <div class="section-header">
                <h2>Hotbar vs Storage</h2>
                <p>Static vs Dynamic slot management</p>
            </div>

            <div class="module-card">
                <div class="module-header">
                    <div class="module-icon">ðŸ“Œ</div>
                    <div class="module-title">
                        <h3>Hotbar (Static)</h3>
                        <p>Fixed slots with nil holes preserved</p>
                    </div>
                </div>
                <p style="color: var(--text-secondary);">
                    Hotbar maintains fixed 1-9 slots. When an item is removed, the slot becomes <code
                        class="inline-code">nil</code>
                    (hole preserved). Slots don't shift.
                </p>
            </div>

            <div class="module-card">
                <div class="module-header">
                    <div class="module-icon">ðŸ“¦</div>
                    <div class="module-title">
                        <h3>Storage (Dynamic)</h3>
                        <p>Packed array that shifts on removal</p>
                    </div>
                </div>
                <p style="color: var(--text-secondary);">
                    Storage is a packed array. When an item is removed via <code
                        class="inline-code">table.remove</code>,
                    items shift up to fill the gap. No holes.
                </p>
            </div>
        </section>

        <section>
            <div class="section-header">
                <h2>Getters</h2>
                <p>Data access methods (no logic)</p>
            </div>

            <table class="api-table">
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Returns</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="method-name">GetItem(uuid)</span></td>
                        <td><span class="param-type">ItemInstance?</span></td>
                        <td>Get item by UUID</td>
                    </tr>
                    <tr>
                        <td><span class="method-name">GetHotbarUUID(slot)</span></td>
                        <td><span class="param-type">string?</span></td>
                        <td>Get UUID in hotbar slot</td>
                    </tr>
                    <tr>
                        <td><span class="method-name">GetStorageUUID(index)</span></td>
                        <td><span class="param-type">string?</span></td>
                        <td>Get UUID in storage index</td>
                    </tr>
                    <tr>
                        <td><span class="method-name">IsEquipped(uuid)</span></td>
                        <td><span class="param-type">boolean</span></td>
                        <td>Check if item is equipped</td>
                    </tr>
                </tbody>
            </table>
        </section>
    </main>
</body>

</html>